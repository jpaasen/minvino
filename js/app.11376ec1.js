(function(e){function t(t){for(var a,r,s=t[0],c=t[1],u=t[2],p=0,m=[];p<s.length;p++)r=s[p],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&m.push(i[r][0]),i[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);l&&l(t);while(m.length)m.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},i={app:0},o=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/minvino/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},5045:function(e,t,n){"use strict";n("5eb1")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("router-link",{attrs:{to:"/"}},[e._v("minVino")])],1),n("router-view")],1)},o=[],r=(n("034f"),n("2877")),s={},c=Object(r["a"])(s,i,o,!1,null,null,null),u=c.exports,l=n("8c4f"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-container",[n("WineTable")],1)],1)},m=[],d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-row",[n("b-col",[n("b-form-select",{attrs:{options:e.wineTableCategories},on:{change:e.fetchFilteredData},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("Filter by category")])]},proxy:!0}]),model:{value:e.selectedCategory,callback:function(t){e.selectedCategory=t},expression:"selectedCategory"}})],1),n("b-col",[n("b-row",{staticClass:"my-1"},[n("b-col",{attrs:{sm:"5"}},[n("label",{attrs:{for:"input-minimumPoints"}},[e._v("Minimum points:")])]),n("b-col",{attrs:{sm:"7"}},[n("b-form-input",{attrs:{id:"input-minimumPoints",state:Number.isInteger(parseInt(e.minimumPoints))},on:{change:e.fetchFilteredData},model:{value:e.minimumPoints,callback:function(t){e.minimumPoints=t},expression:"minimumPoints"}})],1)],1)],1)],1),n("b-table",{ref:"wineTable",attrs:{responsive:"sm",hover:"",selectable:"","sort-by":e.sortBy,"sort-desc":e.sortDesc,items:e.filteredWineTableData,fields:e.fields},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t},"row-clicked":e.viewSingleComponent},scopedSlots:e._u([{key:"cell(score)",fn:function(t){return[e._v(" "+e._s((100*t.value).toFixed(2))+" ")]}}])}),e.fetchingData?n("b-spinner",{attrs:{label:"Loading..."}}):e._e()],1)},f=[],b=(n("4160"),n("159b"),n("96cf"),n("1da1")),g=n("5530"),h=n("2f62"),v={data:function(){return{modes:["multi","single","range"],fields:[{key:"name",sortable:!0},{key:"dnPoints",sortable:!0},{key:"apertifPoints",sortable:!0},{key:"price",sortable:!0},{key:"category",sortable:!0},{key:"volume"},{key:"score",sortable:!0}],selectMode:"multi",selected:[],app:null,collection:null,selectedCategory:null,minimumPoints:90,sortBy:"score",sortDesc:!0,items:[],wineTableCategories:["Sterkvin","Rødvin","Musserende vin","Hvitvin","Brennevin","Øl","Rosévin","Sake","Sider","Perlende vin","Fruktvin","Mjød","Alkoholfritt","Aromatisert vin"]}},computed:Object(g["a"])(Object(g["a"])({},Object(h["b"])({wineTableData:function(e){return e.db.wineTableData},fetchingData:function(e){return e.db.fetchingWineTableData}})),{},{filteredWineTableData:function(){var e=this,t=[];return this.selectedCategory?(this.wineTableData.forEach((function(n){n.category==e.selectedCategory&&t.push(n)})),t):this.wineTableData}}),methods:{viewSingleComponent:function(e){console.log(e),this.$router.push({path:"/wine/".concat(e.productId)})},fetchFilteredData:function(){var e={category:this.selectedCategory,minimumPoints:this.minimumPoints};this.$store.dispatch("db/fetchBaseWineData",e)},inputChange:function(){console.log("input change")}},created:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.dispatch("db/fetchBaseWineData",{minimumPoints:e.minimumPoints});case 1:case"end":return t.stop()}}),t)})))()}},D=v,w=Object(r["a"])(D,d,f,!1,null,null,null),y=w.exports,_={components:{WineTable:y}},T=_,W=Object(r["a"])(T,p,m,!1,null,null,null),P=W.exports,C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",[e.fetchingWineData?n("b-spinner"):n("div",[n("h1",[e._v(e._s(e.wineData.vinmonopoletData.name))]),n("b-row",[n("b-col",{attrs:{sm:"10"}},[n("dl",{staticClass:"row"},[n("dt",{staticClass:"col-sm-3"},[e._v("DN")]),n("dd",{staticClass:"col-sm-9"},[""!=e.wineData.dnPoints?n("div",[n("b",[e._v(e._s(e.wineData.dnPoints)+" Poeng")]),e._v(" "),n("br"),e._v(" "+e._s(e.wineData.dnTasteNote)+" ")]):n("div",[e._v("Ingen rating funnet")])]),n("dt",{staticClass:"col-sm-3"},[e._v("Apertif")]),n("dd",{staticClass:"col-sm-9"},[""!=e.wineData.apertifPoints?n("div",[n("b",[e._v(e._s(e.wineData.apertifPoints)+" Poeng")]),e._v(" "),n("br"),e._v(" "+e._s(e.wineData.apertifTasteNote)+" ")]):n("div",[e._v("Ingen rating funnet")])]),n("dt",{staticClass:"col-sm-3"},[e._v("Link til Vinmonopolet")]),n("dd",{staticClass:"col-sm-9"},[n("a",{attrs:{href:"https://www.vinmonopolet.no/"+e.wineData.vinmonopoletData.url}},[e._v(" "+e._s(e.wineData.vinmonopoletData.name)+" ")])])])]),n("b-col",{attrs:{sm:"2"}},[n("b-img",{attrs:{thumbnail:"",fluid:"",src:e.wineData.vinmonopoletData.images[0].url,alt:"Image 1"}})],1)],1)],1)],1)},k=[],x={name:"SingleWineView",props:{articleNumber:String},computed:Object(g["a"])({},Object(h["b"])({wineData:function(e){return e.db.wineData},fetchingWineData:function(e){return e.db.fetchingWineData}})),created:function(){this.$store.dispatch("db/fetchWineData",this.articleNumber)}},O=x,j=(n("5045"),Object(r["a"])(O,C,k,!1,null,"41ebddde",null)),S=j.exports;a["default"].use(l["a"]);var R=[{path:"/",name:"Home",component:P},{path:"/wine/:articleNumber",component:S,props:!0}],A=new l["a"]({mode:"history",base:"/minvino/",routes:R}),F=A,I=(n("99af"),n("b0c0"),n("d3b7"),n("6062"),n("3ca3"),n("ddb0"),n("d40a")),N=n("bc3a"),B=n.n(N),q={user:null,app:null,wineTableData:[],wineTableCategories:[],fetchingWineTableData:!1,wineData:{},fetchingWineData:!1},E={isAuthenticated:function(e){return!!e.user},appCreated:function(e){return!!e.app}},$={logIn:function(e){return Object(b["a"])(regeneratorRuntime.mark((function t(){var n,a,i,o,r,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.commit,a=e.getters,console.log("Logging in"),a.appCreated){t.next=8;break}return i="minvino-aiide",o={id:i},r=new I["a"](o),t.next=8,n("setApp",r);case 8:if(a.isAuthenticated){t.next=16;break}return s=I["b"].anonymous(),t.next=12,q.app.logIn(s);case 12:return c=t.sent,console.log(c),t.next=16,n("setUser",c);case 16:case"end":return t.stop()}}),t)})))()},fetchBaseWineData:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function n(){var a,i,o,r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=e.dispatch,i=t.category,o=t.minimumPoints,i?(console.log("Fetching data for category "+i),s={query:'\n              {\n                wineData(\n                    sortBy: SCORE_DESC\n                    query: {\n                      AND: [\n                          {\n                              vinmonopoletData: {\n                                buyable: true,\n                                main_category: {\n                                    name: "'.concat(i,'"\n                                }\n                          }}\n                          {\n                            OR: [\n                                {dnPoints_gt: "').concat(o,'"},\n                                {apertifPoints_gt: "').concat(o,'"}\n                            ]\n                            }\n                      ]\n                  }\n                    limit:100\n                  ){\n                  vinmonopoletData {\n                    name,\n                    price {\n                      value\n                    },\n                    main_category {\n                      name\n                    },\n                    main_sub_category {\n                      name\n                    },\n                    volume {\n                        value\n                    }\n                  }\n                  dnPoints\n                  apertifPoints\n                  dnTasteNote\n                  apertifTasteNote\n                  score\n                  productId\n                }\n              }')},a("fetchWineTableData",s)):(r={query:'\n              {\n                wineData(\n                    sortBy: SCORE_DESC\n                    query: {\n                      AND: [\n                          {vinmonopoletData: {\n                              buyable: true,\n                          }}\n                          {\n                              OR: [\n                                  {dnPoints_gt: "'.concat(o,'"},\n                                  {apertifPoints_gt: "').concat(o,'"}\n                              ]\n                          }\n                      ]\n                  }\n                    limit:100\n                  ){\n                  vinmonopoletData {\n                    name,\n                    price {\n                      value\n                    },\n                    main_category {\n                      name\n                    },\n                    main_sub_category {\n                      name\n                    },\n                    volume {\n                        value\n                    }\n                  }\n                  dnPoints\n                  apertifPoints\n                  dnTasteNote\n                  apertifTasteNote\n                  score\n                  productId\n                }\n              }')},a("fetchWineTableData",r));case 3:case"end":return n.stop()}}),n)})))()},fetchWineTableData:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function n(){var a,i,o,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.commit,i=e.getters,o=e.dispatch,a("setWineTableData",[]),a("setFetchingWineTableData",!0),i.isAuthenticated){n.next=6;break}return n.next=6,o("logIn");case 6:return console.log(i.isAuthenticated),n.next=9,q.app.currentUser.refreshCustomData();case 9:r={headers:{Authorization:"Bearer ".concat(q.app.currentUser.accessToken)}},B.a.post("https://realm.mongodb.com/api/client/v2.0/app/minvino-aiide/graphql",t,r).then((function(e){var t=e.data.data.wineData,n=new Set;t.forEach((function(e){n.add(e.vinmonopoletData.main_category.name),e.category=e.vinmonopoletData.main_category.name,e.price=e.vinmonopoletData.price.value,e.name=e.vinmonopoletData.name,e.volume=e.vinmonopoletData.volume.value,delete e.vinmonopoletData})),console.log(e),a("setFetchingWineTableData",!1),a("setWineTableData",t)})).catch((function(e){a("setFetchingWineTableData",!1),console.log(e)}));case 11:case"end":return n.stop()}}),n)})))()},fetchWineTableCategories:function(e){return Object(b["a"])(regeneratorRuntime.mark((function t(){var n,a,i,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.commit,a=e.getters,i=e.dispatch,console.log("fetching wine categories"),n("setWineTableCategories",[]),a.isAuthenticated){t.next=6;break}return t.next=6,i("logIn");case 6:return t.next=8,q.app.currentUser.refreshCustomData();case 8:o={query:"\n          {\n            wineDatum{\n                uniqueCategories\n            }\n          }"},r={headers:{Authorization:"Bearer ".concat(q.app.currentUser.accessToken)}},B.a.post("https://realm.mongodb.com/api/client/v2.0/app/minvino-aiide/graphql",o,r).then((function(e){var t=e.data.data.wineDatum.uniqueCategories;console.log(e.data),n("setWineTableCategories",t)})).catch((function(e){console.log(e)}));case 11:case"end":return t.stop()}}),t)})))()},fetchWineData:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function n(){var a,i,o,r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.commit,i=e.getters,o=e.dispatch,a("setWineData",{}),a("setFetchingWineData",!0),r={query:'\n          {\n            wineData(\n                query: {\n                    productId: "'.concat(t,'"\n              }){\n                vinmonopoletData {\n                    name,\n                    distributor,\n                    images {\n                        url\n                    },\n                    alcohol {\n                      value\n                    },\n                    price {\n                      value\n                    },\n                    main_category {\n                      name\n                    },\n                    main_sub_category {\n                      name\n                    },\n                    volume {\n                        value\n                    }\n                    url\n                  }\n              dnPoints\n              apertifPoints\n              dnTasteNote\n              apertifTasteNote\n              score\n              productId\n            }\n          }')},i.isAuthenticated){n.next=7;break}return n.next=7,o("logIn");case 7:return console.log(i.isAuthenticated),n.next=10,q.app.currentUser.refreshCustomData();case 10:s={headers:{Authorization:"Bearer ".concat(q.app.currentUser.accessToken)}},B.a.post("https://realm.mongodb.com/api/client/v2.0/app/minvino-aiide/graphql",r,s).then((function(e){a("setWineData",e.data.data.wineData[0]),a("setFetchingWineData",!1),console.log(e)})).catch((function(e){a("setFetchingWineData",!1),console.log(e)}));case 12:case"end":return n.stop()}}),n)})))()}},M={setApp:function(e,t){e.app=t},setFetchingWineTableData:function(e,t){e.fetchingWineTableData=t},setWineTableCategories:function(e,t){e.wineTableCategories=t},setWineTableData:function(e,t){e.wineTableData=t},setWineData:function(e,t){e.wineData=t},setFetchingWineData:function(e,t){e.fetchingWineData=t},setUser:function(e,t){e.user=t},logOut:function(e){e.user=null,e.posts=null}},U={state:q,getters:E,actions:$,mutations:M,namespaced:!0};a["default"].use(h["a"]);var z=new h["a"].Store({state:{},mutations:{},actions:{},modules:{db:U}}),L=n("5f5b"),V=n("b1e0");n("f9e3"),n("2dd8");a["default"].config.productionTip=!1,a["default"].use(L["a"]),a["default"].use(V["a"]),new a["default"]({router:F,store:z,render:function(e){return e(u)}}).$mount("#app")},"5eb1":function(e,t,n){},"85ec":function(e,t,n){}});
//# sourceMappingURL=app.11376ec1.js.map